# 3x-ui Secure Installer

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–Ω–µ–ª–∏ **3x-ui** —Å –∑–∞—â–∏—Ç–æ–π **Fail2ban**, —É–º–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∞—Å–∫–∞–¥–Ω–æ–≥–æ VPN.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –†–æ—Å—Å–∏–π—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä (—Å geo-–ø—Ä–∞–≤–∏–ª–∞–º–∏)
```bash
bash <(curl -fsSL https://raw.githubusercontent.com/Saw28rus/xui-installer/main/install-xui-secure.sh) --server-type ru
```

### –ó–∞—Ä—É–±–µ–∂–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞)
```bash
bash <(curl -fsSL https://raw.githubusercontent.com/Saw28rus/xui-installer/main/install-xui-secure.sh) --server-type foreign
```

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Å –≤—ã–±–æ—Ä–æ–º)
```bash
bash <(curl -fsSL https://raw.githubusercontent.com/Saw28rus/xui-installer/main/install-xui-secure.sh)
```

## üìã –ß—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| **3x-ui** | –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Xray —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º |
| **Fail2ban** | –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å-–∞—Ç–∞–∫ –Ω–∞ –ø–∞–Ω–µ–ª—å |
| **Geo-–ø—Ä–∞–≤–∏–ª–∞** (RU) | –£–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è: –†–£-—Å–∞–π—Ç—ã ‚Üí –Ω–∞–ø—Ä—è–º—É—é |
| **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** | –°–≤–æ–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –≤–º–µ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω—ã—Ö |

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

```
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: install-xui-secure.sh [–û–ü–¶–ò–ò]

–û–ø—Ü–∏–∏:
  --server-type TYPE   –¢–∏–ø —Å–µ—Ä–≤–µ—Ä–∞: ru –∏–ª–∏ foreign
  --whitelist-ip IP    IP –¥–ª—è whitelist Fail2ban (–∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
  --skip-fail2ban      –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É Fail2ban
  --uninstall          –£–¥–∞–ª–∏—Ç—å 3x-ui –∏ Fail2ban
  --help, -h           –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
```

## üåê –¢–∏–ø—ã —Å–µ—Ä–≤–µ—Ä–æ–≤

### –†–æ—Å—Å–∏–π—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä (`--server-type ru`)

- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **—Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö geo-—Ñ–∞–π–ª–æ–≤** ([runetfreedom](https://github.com/runetfreedom/russia-v2ray-rules-dat))
- ‚úÖ **–£–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è:**
  - –†–æ—Å—Å–∏–π—Å–∫–∏–µ —Å–∞–π—Ç—ã (`geosite:ru`, `geoip:ru`) ‚Üí –Ω–∞–ø—Ä—è–º—É—é (—ç–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞)
  - –ó–∞—Ä—É–±–µ–∂–Ω—ã–µ —Å–∞–π—Ç—ã ‚Üí —á–µ—Ä–µ–∑ VPN
  - –†–µ–∫–ª–∞–º–∞ (`geosite:category-ads-all`) ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
  - –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ IP ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
  - BitTorrent ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
- ‚úÖ Fail2ban –∑–∞—â–∏—Ç–∞
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å

### –ó–∞—Ä—É–±–µ–∂–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (`--server-type foreign`)

- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ 3x-ui
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö IP –∏ BitTorrent
- ‚úÖ Fail2ban –∑–∞—â–∏—Ç–∞
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å

## üîó –ö–∞—Å–∫–∞–¥–Ω—ã–π VPN

```
–ö–ª–∏–µ–Ω—Ç ‚Üí –†–æ—Å—Å–∏–π—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä ‚Üí –ó–∞—Ä—É–±–µ–∂–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ‚Üí –ò–Ω—Ç–µ—Ä–Ω–µ—Ç
         (VLESS+Reality)      (VLESS+Reality)
```

### –°—Ö–µ–º–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞ RU-—Å–µ—Ä–≤–µ—Ä–µ:
```
yandex.ru, vk.com, ok.ru  ‚Üí  –ù–ê–ü–†–Ø–ú–£–Æ (–±–µ–∑ VPN, –±—ã—Å—Ç—Ä–æ)
youtube.com, google.com    ‚Üí  –ß–µ—Ä–µ–∑ –∑–∞—Ä—É–±–µ–∂–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–∫–∞—Å–∫–∞–¥)
–†–µ–∫–ª–∞–º–∞                    ‚Üí  –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–ê
```

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ Fail2ban

- **10 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞** ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ **1 —á–∞—Å**
- **Whitelist**: –≤–∞—à IP –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –∂—É—Ä–Ω–∞–ª `systemd` —Å–µ—Ä–≤–∏—Å–∞ `x-ui`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# –°—Ç–∞—Ç—É—Å –∑–∞—â–∏—Ç—ã
fail2ban-client status x-ui

# –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP
fail2ban-client set x-ui unbanip 1.2.3.4

# –õ–æ–≥–∏
tail -f /var/log/fail2ban.log
```

## üö´ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ BitTorrent

### ‚ö†Ô∏è –í–∞–∂–Ω–æ: BitTorrent –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç BitTorrent-—Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è:
- **–≠–∫–æ–Ω–æ–º–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞** ‚Äî BitTorrent –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –º–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤
- **–ó–∞—â–∏—Ç—ã –æ—Ç DMCA** ‚Äî —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –∂–∞–ª–æ–± –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏** ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É —Å–µ—Ä–≤–µ—Ä–∞

### ‚úÖ –ö–∞–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å BitTorrent

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ä—Ä–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ VPN, –≤—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å BitTorrent:

#### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –≤–µ–±-–ø–∞–Ω–µ–ª—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å 3x-ui: `https://–í–ê–®_IP:–ü–û–†–¢/WebBasePath`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Xray** ‚Üí **Routing**
3. –ù–∞–π–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–æ —Å `"protocol": ["bittorrent"]` –∏ `"outboundTag": "blocked"`
4. **–í–∞—Ä–∏–∞–Ω—Ç –ê:** –£–¥–∞–ª–∏—Ç–µ —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é
5. **–í–∞—Ä–∏–∞–Ω—Ç –ë:** –ò–∑–º–µ–Ω–∏—Ç–µ `"outboundTag": "blocked"` –Ω–∞ `"outboundTag": "proxy"`
6. –ù–∞–∂–º–∏—Ç–µ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å** –∏ **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Xray**

#### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É

```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å config.json
nano /usr/local/x-ui/bin/config.json

# –ù–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ:
{
  "type": "field",
  "outboundTag": "blocked",
  "protocol": ["bittorrent"]
}

# –£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å "blocked" –Ω–∞ "proxy"
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+O, Enter, Ctrl+X)

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Xray
systemctl restart x-ui
```

### üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ **—Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ VPN**
- –ï—Å–ª–∏ –≤—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ VPN, BitTorrent —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é
- –ü–æ—Å–ª–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤–µ—Å—å BitTorrent-—Ç—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ VPN

## üì¶ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- **Ubuntu** 22.04 / 24.04
- **Debian** 11 / 12
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** x86_64, aarch64
- **–ú–∏–Ω–∏–º—É–º RAM:** 512 MB

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ ‚Äî –æ–Ω –æ–±–Ω–∞—Ä—É–∂–∏—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç:
1. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë —Å –Ω—É–ª—è
2. –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Fail2ban
3. –û–±–Ω–æ–≤–∏—Ç—å geo-–ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
4. –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –ø–∞–Ω–µ–ª–∏

## üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ

```bash
bash install-xui-secure.sh --uninstall
```

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–∞–Ω–µ–ª–∏ **3x-ui** ‚Äî –º–æ—â–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Xray-core.

- **–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç 3x-ui:** [MHSanaei/3x-ui](https://github.com/MHSanaei/3x-ui) ‚Äî –≤–µ–±-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Xray —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- **–†–æ—Å—Å–∏–π—Å–∫–∏–µ geo-–ø—Ä–∞–≤–∏–ª–∞:** [runetfreedom/russia-v2ray-rules-dat](https://github.com/runetfreedom/russia-v2ray-rules-dat) ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.

---

**3x-ui** —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π [GPL-3.0](https://github.com/MHSanaei/3x-ui/blob/main/LICENSE).
